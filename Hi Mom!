provide an employee and get all the levels of supervisor

WITH employee_hierarchy AS (

SELECT

employee_code,

sup employee_code

FROM emp sup_test WHERE employee_code = "e7"

UNION ALL SELECT

e.employee_code,

e.sup_employee_code

FROM emp sup_test as e, employee_hierarchy

WHERE e.employee_code employee

SELECT

FROM employee hierarchy

provide a employee and get his reportees at all levels

WITH employee hierarchy AS ( SELECT

employee code, sup employee code

FROM emp sup_test WHERE sup_employee_code e31

UNION ALL

SELECT

e.employee code,

e.sup employee_code

FROM emp sup test e, employee hierarchy WHERE e.sup employee_code- employee hierarchy.employee_code

SELECT

FROM employee hierarchy
